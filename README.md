# Video Downloader（安卓本地下载）

> 文档版本：v1.1.0  
> 最后更新：2026-02-10

一个仅用于个人本地使用的安卓视频下载工具，当前重点支持抖音与 X 链接解析、格式选择、本地下载、历史管理。

## 当前实现
- 支持抖音分享文案提取链接并解析。
- 支持 X 普通视频与部分 m3u8/直播回放链接解析（受站点策略与网络环境影响）。
- 支持下载队列、失败重试、历史管理、已完成管理。
- 支持 X Cookie 本地保存、校验、网页登录回填。
- 支持下载前后双阶段校验，自动拦截空文件/网页内容/异常文件。
- 支持同名文件自动重命名：`标题.mp4`、`标题(1).mp4`、`标题(2).mp4`。
- 支持格式信息增强：时长、大小（可探测时）、m3u8 分片流标识。
- 支持推荐排序：仅在“多选项且拿到可判断质量信息”时推荐并置顶。
- 支持无质量信息的分片流“预览”按钮，便于手动判断。

## 快速开始
### Android Studio
1. 打开项目目录：`D:\Video Downloader`
2. 等待 Gradle Sync 完成
3. 运行 `app` 到真机（Android 10+）

### 终端构建
```powershell
.\环境一键配置.ps1
.\gradlew.bat :app:assembleDebug
```

APK 输出：`app/build/outputs/apk/debug/app-debug.apk`

## 常用命令
```powershell
# 构建 Debug APK
.\gradlew.bat :app:assembleDebug

# 安装到已连接设备
.\gradlew.bat :app:installDebug

# 清理构建产物与临时目录
.\项目清理.ps1
```

## 关键行为说明
### m3u8
- m3u8 是分片流，解析阶段通常拿不到最终合并后精确文件大小。
- UI 显示为“分片流 · 最终大小以下载后为准”。
- 若无法拿到分辨率/码率等质量信息，会提供“预览”按钮。

### 推荐排序
- 只有 1 个选项：不推荐、不排序。
- 选项 > 1 且拿到可判断质量信息（分辨率/码率/大小）时，推荐项置顶并高亮。
- 拿不到质量信息时保持原始顺序。

## 文档导航
- `需求说明.md`：范围、目标与验收基线
- `技术设计文档.md`：架构与核心流程设计
- `启动说明.md`：环境与运行步骤
- `失败场景回归测试清单.md`：回归测试项
- `docs/项目维护手册.md`：维护与排障指引

## 变更记录
- 2026-02-10 16:39 v1.0.0：建立文档版本头与统一维护入口，完成与当时实现对齐
- 2026-02-10 22:40 v1.1.0：文档重写并对齐当前实现（推荐排序、m3u8 预览、同名重命名、历史页管理交互）
