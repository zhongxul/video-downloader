# 安卓本地视频下载 App 需求说明（当前基线）

> 文档版本：v1.1.0  
> 最后更新：2026-02-10

## 1. 目标
- 面向个人自用场景，提供抖音与 X 链接解析、本地下载与历史管理。
- 不依赖自建后端，不依赖额外设备，数据仅存本机。
- 重点保证：可解析、可下载、可播放、可定位失败原因。

## 2. 范围
### 2.1 在范围内
- 链接/分享文案输入与 URL 提取。
- 抖音与 X 链接解析、可下载格式展示。
- 下载任务创建、状态同步、失败重试。
- 解析记录与下载队列管理（含批量操作）。
- X Cookie 手动与网页登录回填。
- 下载结果有效性校验与异常文件自动清理。

### 2.2 不在范围内
- 云端账号与多端同步。
- iOS 支持。
- 面向上架的商业化流程。

## 3. 核心功能需求
### 3.1 解析与格式展示
- 支持从抖音分享长文本中提取真实链接。
- 解析结果至少展示：分辨率/扩展名、可下载性。
- 可获取时展示：时长、大小、码率。
- m3u8 显示为“分片流，最终大小以下载后为准”。

### 3.2 推荐排序
- 单个选项：不推荐、不排序。
- 多个选项且可判断质量时：推荐项置顶。
- 质量判断信息优先级：分辨率 > 码率 > 可用大小。
- 拿不到质量信息时保持原始顺序。

### 3.3 分片流预览
- 对“拿不到质量信息”的分片流选项，提供预览入口。
- 点击预览可调用外部播放器/浏览器打开链接。

### 3.4 下载与文件管理
- 创建任务后进入下载队列，支持重试与取消。
- 同名文件自动重命名：`标题(1)`、`标题(2)`…
- 下载成功后文件可被系统媒体库识别。
- 异常结果自动判失败并删除，不进入“已完成”。

### 3.5 历史管理
- 历史页包含解析记录与下载队列切换。
- 管理模式支持：多选、全选、删除、分享。
- 支持长按记录直接进入管理并选中。

## 4. 非功能需求
- 稳定性：网络波动时不崩溃，并提供可读错误提示。
- 可维护性：业务规则集中在 UseCase/Gateway，UI 不写数据一致性逻辑。
- 隐私：Cookie 与历史仅本地保存，不上传服务器。

## 5. 验收基线
- 抖音链接可稳定解析并下载。
- X 普通视频在 Cookie 有效时可解析并下载。
- m3u8 链接在可解析时展示分片流信息；无质量信息时可预览。
- 推荐排序仅在符合触发条件时出现。
- 同名下载文件不会覆盖。

## 变更记录
- 2026-02-10 16:39 v1.0.0：按当时实现重写需求基线，明确范围与验收边界
- 2026-02-10 22:40 v1.1.0：新增 m3u8 预览、推荐触发条件、同名重命名等需求条目
